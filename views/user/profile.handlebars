	<title>Bratil - Perfil do usuário {{user.name}}</title>
	<style>
		@font-face {
	    font-family: 'main-font';
	    src: url('/css/fonts/Poppins-Light.ttf');
	  }
		* {
			margin: 0px;
			padding: 0px;
		}
		
		body {
			font-family: 'main-font';
			color: white;
			background: rgb(32,33,37);
		}
		
		.welcome-to-profile {
			color: rgb(0,170,255);
			height: 200px;
			margin-top: 50px;
			margin-bottom: 25px;
		}
		
		.welcome {
			font-size: 25pt;
		}
		
		h2 {
			font-size: 20pt;
		}
		
		.card-h2 {
			font-size: 15pt;
		}
		
		hr {
			background: white;
		}
		
	.exit-container {
		z-index: 10;
		position: absolute;
		top: 5px;
		right: 5px;
		width: 45px;
		height: 45px;
		background: rgb(32,33,37);
		box-shadow: 1px 1px 10px black;
		border-radius: 100%;
	}
	
	.exit-container .bi-box-arrow-right {
		color: rgb(0,140,255);
		font-size: 18pt;
	}
	
	section hr {
		margin-top: 50px;
		margin-bottom: 50px;
	}
	
	#BlackTheme {
		width: 50px;
		height: 20px;
		appearance: none;
		background: white;
		border-radius: 20px;
		transition: all .2s;
		outline: none;
		position: relative;
		float: right;
	}
	
	#BlackTheme:checked {
		background: rgb(0, 140, 255);
	}
	
	#BlackTheme:before {
		position: absolute;
		content: '';
		left: 0px;
		width: 20px;
		height: 20px;
		border-radius: 20px;
		background: white;
		box-shadow: 1px 0px 10px black;
	}
	
	#BlackTheme:checked:before {
		box-shadow: -1px 0px 10px black;
		position: absolute;
		left: 100%;
		transform: translateX(-100%);
	}
	
	</style>
</head>
<body>
{{>_alert}}
{{#if error_msg}}
<script>
	BratilAlert({
		title: 'erro:',
		body: `{{error_msg}}`,
		button: 'OK, não tem problema!'
	})
</script>
{{/if}}
	<div class="container text-center">
		<div class="exit-container text-center">
			<a href="/user/logout">
				<i class="bi bi-box-arrow-right"></i>
			</a>
		</div>
		
		<img class="welcome-to-profile" src="/img/welcome.png">
		<h1 class="welcome mb-5">Bem-vindo {{user.name}}!</h1>
		
		{{#if user.branch}}
			<a href="{{branch.router}}">
				<button class="BratilButton mt-4">Página de administração</button>
			</a>
		{{/if}}
		
		<button onclick="DeleteAccount()" class="BratilButton mt-4" style="background:red;">Apagar minha conta</button>
		
	</div>
	<section class="container mt-5">
		<div id="UserData">
			<form>
				<h2 class="mb-3">Usuário:</h2>
				<label for="name">Nome:</label>
				<input value="{{user.name}}" id="name" placeholder="digite aqui o seu nome" type="text" name="name" class="form-control" required> <br>
				<label for="email">E-mail:</label>
				<input value="{{user.email}}" id="email" placeholder="digite aqui o seu e-mail" type="email" name="email" class="form-control" required> <br>
				<label for="gender">Seu gênero:</label>
				<select name="gender" id="gender" class="form-control">
					<option value="male">masculino</option>
					<option value="female">feminino</option>
				</select><br>
				<a href="/user/forgot">Redefinir senha</a>
				<button onclick="UpdateProfile()" type="button" class="BratilButton mt-4">Salvar</button>
			</form>
		</div>
		<hr>
		<!--
		<div id="SiteData">
			<h2 class="mb-3">Site:</h2>
			<label for="BlackTheme">Tema escuro</label>
			<p style="font-size:5pt;">ative ou desative a cor </p>
			<input type="checkbox" id="BlackTheme">
		</div>
		-->
	</section>
	
	<div style="margin-top:120px;">
		{{>_footer}}
	</div>
	<script>
		var gender = document.querySelector('#gender')
		//alert(gender.options.length)
		for (let i = 0; i < gender.options.length; i++) {
			if (gender.options[i].value == '{{user.gender}}') {
				gender.options[i].selected = true
			}
		}
		
		
		function DeleteAccount() {
			BratilAlert({
				title: 'Excluir conta',
				body: 'Você realmente deseja excluir sua conta? Todos os dados vinculados a sua conta da Bratil serão apagados. Caso você realmente queira click no butão abaixo, caso não queira click em qualquer lugar ao redor deste pop-up!',
				button: 'Sim, quero excluir minha conta!'
			})
			
			BratilAlertAgreed().then(() => {
				fetch('/user/delete?cookie='+encodeURIComponent(document.cookie), { method: 'DELETE' }).then(async (data) => {
					
					data = await data.json()
					
					if (data.OK) {
						BratilAlert({
							title: 'Conta excluida',
							body: data.message,
							button: 'Certo, obrigado!'
						})
						setTimeout(() => {
							window.location = '/'
						}, 1000)
					} else {
						BratilAlert({
							title: 'Erro:',
							body: data.message,
							button: 'Certo, não tem problema!'
						})
					}
				}).catch((error) => {
					BratilAlert({
							title: 'Erro:',
							body: 'Houve um erro desconhecido ao excluir sua conta!',
							button: 'Certo, não tem problema!'
						})
				})
			})
			
		}
		
		function UpdateProfile() {
			
			BratilAlert({
				title: 'Atualizar conta',
				body: 'Você realmente deseja salvar as atualizações que você fez na sua conta?',
				button: 'Sim, eu quero!'
			})
			
			BratilAlertAgreed().then(() => {
				var name = document.getElementById('name')
				var email = document.getElementById('email')
				var gender = document.getElementById('gender')
				
				var DataToSend = {name: name.value, email: email.value, gender: gender.value}
				socket.emit('UpdateMyUserAcount', DataToSend)
				document.querySelector('.welcome').innerText = 'Bem-vindo '+name.value+'!'
			})
		}
	</script>
</body>